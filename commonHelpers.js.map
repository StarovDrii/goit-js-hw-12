{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n// import renderImages from './modules/renderImagesFoo.js';\n// import galleryReset from './modules/galleryResetFoo.js';\n// import handlerLoadMoreBtn from './modules/handlerLoadMoreBtnFoo.js';\n// import loadMoreImages from './modules/loadMoreImagesFoo.js';\n// import { gallery } from './modules/renderImagesFoo.js';\n\n// export\nconst form = document.querySelector('.form'),\n  searchInput = document.querySelector('.search-input'),\n  loader = document.querySelector('.loader'),\n  loadMoreBtn = document.querySelector('.load-more-btn');\n\nform.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', loadMoreImages);\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\n// export\nlet page = 1;\n// export\nconst per_page = 40;\nlet searchInputValue;\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  galleryReset();\n  searchInputValue = searchInput.value;\n  await fetchImages();\n}\n\nasync function fetchImages() {\n  const response = await axios\n    .get('/api', {\n      params: {\n        key: '41798579-68ab5b2702b30822247f51cf8',\n        q: searchInput.value,\n        orientation: 'horizontal',\n        image_type: 'photo',\n        safesearch: true,\n        page,\n        per_page,\n      },\n    })\n    .then(response => {\n      if (response.data.hits.length === 0) {\n        return iziToast.warning({\n          title: 'Ooops',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n        });\n      }\n      renderImages(response.data.hits);\n      handlerLoadMoreBtn(response.data.totalHits);\n    })\n    .catch(\n      iziToast.error({\n        title: 'Error',\n        message: 'Something is wrong!',\n        position: 'topRight',\n      })\n    )\n    .finally(() => {\n      loader.classList.add('is-hidden');\n      // form.reset();\n    });\n}\nconst gallery = document.querySelector('.gallery');\nfunction renderImages(images) {\n  page++;\n\n  const galleryMarkup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"gallery-image\"/>\n        </a>\n        <div class=\"image-desc\">\n          <div class=\"image-desc-item\">\n            <div class=\"image-desc-label\">Likes</div>\n            <div>${likes}</div>\n          </div>\n          <div class=\"image-desc-item\">\n            <div class=\"image-desc-label\">Views</div>\n            <div>${views}</div>\n          </div>\n          <div class=\"image-desc-item\">\n            <div class=\"image-desc-label\">Comments</div>\n            <div>${comments}</div>\n          </div>\n          <div class=\"image-desc-item\">\n            <div class=\"image-desc-label\">Downloads</div>\n            <div>${downloads}</div>\n          </div>\n        </div>\n      </li>\n      `\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n  new SimpleLightbox('.gallery a').refresh();\n}\n\nasync function loadMoreImages() {\n  loader.classList.remove('is-hidden');\n  loadMoreBtn.classList.add('is-hidden');\n  await fetchImages();\n}\n\nfunction galleryReset() {\n  page = 1;\n  gallery.innerHTML = '';\n  loader.classList.remove('is-hidden');\n  loadMoreBtn.classList.add('is-hidden');\n}\n\nfunction handlerLoadMoreBtn(totalHits) {\n  const maxPages = Math.ceil(totalHits / per_page);\n  if (page > maxPages) {\n    return iziToast.warning({\n      title: 'Ooops',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n  } else {\n    loadMoreBtn.classList.remove('is-hidden');\n  }\n}\n// export default fetchImages;\n"],"names":["form","searchInput","loader","loadMoreBtn","handleFormSubmit","loadMoreImages","axios","page","per_page","event","galleryReset","fetchImages","response","iziToast","renderImages","handlerLoadMoreBtn","gallery","images","galleryMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","totalHits","maxPages"],"mappings":"owBAYA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACzCC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAEvDH,EAAK,iBAAiB,SAAUI,CAAgB,EAChDD,EAAY,iBAAiB,QAASE,CAAc,EAEpDC,EAAM,SAAS,QAAU,sBAGzB,IAAIC,EAAO,EAEX,MAAMC,EAAW,GAGjB,eAAeJ,EAAiBK,EAAO,CACrCA,EAAM,eAAc,EACpBC,IACmBT,EAAY,MAC/B,MAAMU,EAAW,CACnB,CAEA,eAAeA,GAAc,CACV,MAAML,EACpB,IAAI,OAAQ,CACX,OAAQ,CACN,IAAK,qCACL,EAAGL,EAAY,MACf,YAAa,aACb,WAAY,QACZ,WAAY,GACZ,KAAAM,EACA,SAAAC,CACD,CACP,CAAK,EACA,KAAKI,GAAY,CAChB,GAAIA,EAAS,KAAK,KAAK,SAAW,EAChC,OAAOC,EAAS,QAAQ,CACtB,MAAO,QACP,QACE,2EACF,SAAU,UACpB,CAAS,EAEHC,EAAaF,EAAS,KAAK,IAAI,EAC/BG,EAAmBH,EAAS,KAAK,SAAS,CAChD,CAAK,EACA,MACCC,EAAS,MAAM,CACb,MAAO,QACP,QAAS,sBACT,SAAU,UAClB,CAAO,CACF,EACA,QAAQ,IAAM,CACbX,EAAO,UAAU,IAAI,WAAW,CAEtC,CAAK,CACL,CACA,MAAMc,EAAU,SAAS,cAAc,UAAU,EACjD,SAASF,EAAaG,EAAQ,CAC5BV,IAEA,MAAMW,EAAgBD,EACnB,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACD,IACC;AAAA;AAAA,mBAEWL;AAAA,sBACGD,WAAsBE;AAAA;AAAA;AAAA;AAAA;AAAA,mBAKzBC;AAAA;AAAA;AAAA;AAAA,mBAIAC;AAAA;AAAA;AAAA;AAAA,mBAIAC;AAAA;AAAA;AAAA;AAAA,mBAIAC;AAAA;AAAA;AAAA;AAAA,OAKd,EACA,KAAK,EAAE,EACVT,EAAQ,mBAAmB,YAAaE,CAAa,EACrD,IAAIQ,EAAe,YAAY,EAAE,SACnC,CAEA,eAAerB,GAAiB,CAC9BH,EAAO,UAAU,OAAO,WAAW,EACnCC,EAAY,UAAU,IAAI,WAAW,EACrC,MAAMQ,EAAW,CACnB,CAEA,SAASD,GAAe,CACtBH,EAAO,EACPS,EAAQ,UAAY,GACpBd,EAAO,UAAU,OAAO,WAAW,EACnCC,EAAY,UAAU,IAAI,WAAW,CACvC,CAEA,SAASY,EAAmBY,EAAW,CACrC,MAAMC,EAAW,KAAK,KAAKD,EAAYnB,CAAQ,EAC/C,GAAID,EAAOqB,EACT,OAAOf,EAAS,QAAQ,CACtB,MAAO,QACP,QAAS,6DACT,SAAU,UAChB,CAAK,EAEDV,EAAY,UAAU,OAAO,WAAW,CAE5C"}